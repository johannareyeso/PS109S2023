panel = TRUE)
summary(atts)
(atts)
ggdid(atts)
att.gt <- aggte(atts, type = "group", na.rm = T)
summary(att.gt)
att.dyn <- aggte(atts, type = "dynamic")
summary(att.dyn)
ggdid(att.dyn)
ggdid(att.gt)
ggdid(att.gt)
ggsave("att.gt.png", width= 12, height = 6)
att.dyn <- aggte(atts, type = "dynamic")
summary(att.dyn)
ggdid(att.dyn)
ggsave("att.dyn.png", width= 12, height = 6)
att.cal <- aggte(atts, type = "calendar")
summary(att.cal)
ggdid(att.cal)
ggsave("att.cal.png", width= 10, height = 6)
summary(att.dyn)
summary(atts)
summary(att.gt)
summary(atts)
summary(att.dyn)
summary(att.cal)
summary(att.dyn)
knitr::opts_chunk$set(echo = TRUE)
library(did)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(wesanderson)
library(stargazer)
library(kableExtra)
library(xtable)
library(stringi)
library(tidyr)
library(RColorBrewer)
setwd("C:/Users/hanna/My Drive/Research/Guatemala/Datos")
setwd("G:/My Drive/Research/Guatemala/Datos")
sent1 <- read.csv("2011-2022-part-1.csv")
sent1 <- read.csv("2011-2022-part-1")
setwd("G:/My Drive/Research/Guatemala/Datos")
sent1 <- read.csv("2011-2022-part-1")
setwd("G:/My Drive/Research/Guatemala")
sent1 <- read.csv("2011-2022-part-1")
sent4 <- read.csv("2011-2022-part-4")
sent4 <- read.csv("2011-2022-part-4.csv")
sent1 <- read.csv("2011-2022-part-1.csv")
sent2 <- read.csv("2011-2022-part-2.csv")
sent3 <- read.csv("2011-2022-part-3.csv")
sent4 <- read.csv("2011-2022-part-4.csv")
# Merge all parts into new data frame
estadocaso <- rbind(sent1, sent2, sent3, sent4)
View(sent1)
View(sent2)
View(sent4)
#rename columns
colnames(sent1)[1:7] <- c(year, depto, munip, status, age, victims)
#rename columns
colnames(sent1)[1:7] <- c("year", "depto", "munip", "status", "age", "victims")
#rename columns
colnames(sent1)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
#drop last column
sent1 <- sent1[, -8]
sent1 <- subset(sent1, crime != "Delito")
sent1 <- sent1[complete.cases(sent1), ]
sent1 <- sent1[complete.cases(sent1), ]
sent1 <- na.omit(sent1)
sent1 <- subset(sent1, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
colnames(sent2)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
sent2 <- sent2[, -8]
sent2 <- subset(sent2, crime != "Delito")
sent2 <- subset(sent1, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent2 <- read.csv("2011-2022-part-2.csv")
sent1 <- read.csv("2011-2022-part-1.csv")
sent2 <- read.csv("2011-2022-part-2.csv")
sent3 <- read.csv("2011-2022-part-3.csv")
sent4 <- read.csv("2011-2022-part-4.csv")
sent1 <- read.csv("2011-2022-part-1.csv")
sent2 <- read.csv("2011-2022-part-2.csv")
sent3 <- read.csv("2011-2022-part-3.csv")
sent4 <- read.csv("2011-2022-part-4.csv")
colnames(sent1)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
colnames(sent2)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
colnames(sent3)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
colnames(sent4)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
sent1 <- sent1[, -8]
sent2 <- sent2[, -8]
sent3 <- sent3[, -8]
sent4 <- sent4[, -8]
sent1 <- subset(sent1, crime != "Delito")
sent1 <- subset(sent1, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent2 <- subset(sent2, crime != "Delito")
sent2 <- subset(sent2, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent3 <- subset(sent3, crime != "Delito")
sent3 <- subset(sent3, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent4 <- subset(sent4, crime != "Delito")
sent4 <- subset(sent4, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
View(sent3)
# Merge all parts into new data frame
casestatus <- rbind(sent1, sent2, sent3, sent4)
# Merge all parts into new data frame
casestat <- rbind(sent1, sent2, sent3, sent4)
View(casestat)
sent2 <- subset(sent2, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent2 <- subset(sent2, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NINEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent4 <- subset(sent4, crime != "Delito")
sent4 <- subset(sent4, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent4 <- subset(sent4, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NINEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent4 <- subset(sent4, crime != "*Fuente: Departamento del Sistema Informatico Fiscal y Tecnico -SIFT-. ** Reporte generado el  13/03/2023 de la base de datos actualizada al  12/03/2023.")
sent4 <- subset(sent4, crime != "*Fuente: Departamento del Sistema Informatico Fiscal y Tecnico -SIFT-. ** Reporte generado el  13/03/2023 de la base de datos actualizada al  12/03/2023.")
sent4 <- sent4[-20225, ]
sent1 <- read.csv("2011-2022-part-1.csv")
sent2 <- read.csv("2011-2022-part-2.csv")
sent3 <- read.csv("2011-2022-part-3.csv")
sent4 <- read.csv("2011-2022-part-4.csv")
#rename columns
colnames(sent1)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
colnames(sent2)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
colnames(sent3)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
colnames(sent4)[1:7] <- c("crime", "year", "depto", "munip", "status", "age", "victims")
#drop last column
sent1 <- sent1[, -8]
sent2 <- sent2[, -8]
sent3 <- sent3[, -8]
sent4 <- sent4[, -8]
#drop label rows that repeated in pdf - ie full-length rows that labeled each page
sent1 <- subset(sent1, crime != "Delito")
sent1 <- subset(sent1, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent2 <- subset(sent2, crime != "Delito")
sent2 <- subset(sent2, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NINEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent3 <- subset(sent3, crime != "Delito")
sent3 <- subset(sent3, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NInEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent4 <- subset(sent4, crime != "Delito")
sent4 <- subset(sent4, crime != "REPORTE ESTADISTICO A NIVEL NACIONAL POR DEPARTAMENTOS, NINEZ, ADOLESCENCIA Y MUJERES ADULTAS  VICTIMAS POR DELITOS DE VIOLENCIA SEXUAL, REGISTRADOS EN EL PERIODO COMPRENDIDO DEL 01/01/2011 AL 31/12/2022")
sent4 <- sent4[-20225, ]
View(sent4)
sent4 <- sent4[-20225, ]
View(sent4)
View(sent3)
sent4 <- subset(sent4, crime != "*Fuente: Departamento del Sistema Informatico Fiscal y Tecnico -SIFT-. ** Reporte generado el  13/03/2023 de la base de datos actualizada al  12/03/2023.")
casestat <- rbind(sent1, sent2, sent3, sent4)
View(casestat)
casestat <- casestat[-202253, ]
knitr::opts_chunk$set(echo = TRUE)
library(did)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(wesanderson)
library(stargazer)
library(kableExtra)
library(xtable)
library(stringi)
library(tidyr)
library(RColorBrewer)
casestat <- casestat[-c(202253,202243), ]
casestat <- casestat [1:202233, ]
write.csv(casestat, "casestat.csv", row.names = FALSE)
casestat <- read.csv("casestat.csv")
casestat <- na.omit(read.csv("casestat.csv"))
caseagg <- casestat %>% group_by(munip, year)
View(caseagg)
caseagg <- casestat %>%
group_by(munip, year, status) %>%
count() %>%
View(caseagg)
# Group by municipality, year, and status and count the number of cases
caseagg <- casestat %>%
group_by(munip, year, status) %>%
count() %>%
ungroup()
View(caseagg)
caseagg <- caseagg  %>%
pivot_wider(names_from = "status", values_from = "n", values_fn = sum)
caseagg[is.na(caseagg)] <- 0
write.csv(caseagg, "caseagg.csv", row.names = FALSE)
View(sexvpop)
knitr::opts_chunk$set(echo = TRUE)
library(did)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(wesanderson)
library(stargazer)
library(kableExtra)
library(xtable)
library(stringi)
library(tidyr)
library(RColorBrewer)
# Merge case status data with sexual violence data
sexvstat <- merge(sexvpop, caseagg, by = c("munip", "year"), all = TRUE)
View(sexvstat)
#Capitalize munip values to merge with sexual violence data
caseagg$munip <- toupper(caseagg$munip)
write.csv(caseagg, "caseagg.csv", row.names = FALSE)
sexvstat <- merge(sexvpop, caseagg, by = c("munip", "year"), all = TRUE)
sexvstat[is.na(sexvstat)] <- 0
write.csv(sexvstat, "sexvstat.csv", row.names = FALSE)
# Create variable for percentage of sentenced cases
sexvstat$s_rate <- round((sexvstat$Sentenciado / sexvstat$reported), 2)
write.csv(sexvstat, "sexvstat.csv", row.names = FALSE)
View(plot1)
View(plot1)
plot
parallel_sent <- ggplot(sexvstat, aes(x=year, y= s_rate, group = treatment, color = treatment))+
stat_summary(fun = "mean", geom = "line", na.rm = TRUE)+
theme_minimal()+
geom_vline(xintercept=2009, color = "#CD9600") +
annotate(geom="text", x=2009.5, y=-1, label="Policy Rollout")+
labs(title= "Average Crime Rate by Treatment Group",
subtitle= "Does the parallel trend assumption hold?",
x = "Year",
y = "Average Crime Rate, rate per 10,000 pop.",
color = "Treatment Group")+
scale_color_manual(values= wes_palette("Darjeeling1", n = 2))+
xlim(2011, 2021)
parallel_sent
stat_summary(fun = "mean", geom = "line", na.rm = TRUE)+
theme_minimal()+
geom_vline(xintercept=2009, color = "#CD9600") +
annotate(geom="text", x=2009.5, y=-1, label="Policy Rollout")+
labs(title= "Average Crime Rate by Treatment Group",
subtitle= "Does the parallel trend assumption hold?",
x = "Year",
y = "Average Crime Rate, rate per 10,000 pop.",
color = "Treatment Group")+
scale_color_manual(values= wes_palette("Darjeeling1", n = 2))+
xlim(2011, 2021)+
ylim(0, 1)
parallel_sent
parallel_sent <- ggplot(sexvstat, aes(x=year, y= s_rate, group = treatment, color = treatment))+
stat_summary(fun = "mean", geom = "line", na.rm = TRUE)+
theme_minimal()+
geom_vline(xintercept=2009, color = "#CD9600") +
annotate(geom="text", x=2009.5, y=-1, label="Policy Rollout")+
labs(title= "Average Crime Rate by Treatment Group",
subtitle= "Does the parallel trend assumption hold?",
x = "Year",
y = "Average Crime Rate, rate per 10,000 pop.",
color = "Treatment Group")+
scale_color_manual(values= wes_palette("Darjeeling1", n = 2))+
xlim(2011, 2021) +
ylim(0, 1)
parallel_sent
parallel_sent <- ggplot(sexvstat, aes(x=year, y= s_rate, group = treatment, color = treatment))+
stat_summary(fun = "mean", geom = "line", na.rm = TRUE)+
theme_minimal()+
geom_vline(xintercept=2009, color = "#CD9600") +
annotate(geom="text", x=2009.5, y=-1, label="Policy Rollout")+
labs(title= "Average Crime Rate by Treatment Group",
subtitle= "Does the parallel trend assumption hold?",
x = "Year",
y = "Average Crime Rate, rate per 10,000 pop.",
color = "Treatment Group")+
scale_color_manual(values= wes_palette("Darjeeling1", n = 2))+
xlim(2011, 2021) +
ylim(0, 0.25)
parallel_sent
ggsave("parallel_sent.png", width=10)
ggdid(att.dyn)
ggdid(att.cal)
atts_sent <- att_gt(yname = "s_rate",
tname = "year",
idname = "munip_id",
gname = "first_treat",
xformla = s_rate ~ population,
data = sexvstat,
est_method = "dr",
control_group = "nevertreated",
bstrap = TRUE,
clustervars = NULL,
panel = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(did)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(wesanderson)
library(stargazer)
library(kableExtra)
library(xtable)
library(stringi)
library(tidyr)
library(RColorBrewer)
atts_sent
sexvstat <- read.csv("sexvstat.csv")
atts_sent <- att_gt(yname = "s_rate",
tname = "year",
idname = "munip_id",
gname = "first_treat",
xformla = s_rate ~ population,
data = sexvstat,
est_method = "dr",
control_group = "nevertreated",
bstrap = TRUE,
clustervars = NULL,
panel = TRUE)
View(sexvstat)
knitr::opts_chunk$set(echo = TRUE)
library(did)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(wesanderson)
library(stargazer)
library(kableExtra)
library(xtable)
library(stringi)
library(tidyr)
library(RColorBrewer)
sexvstat <- sexvstat %>%
filter(year != 2022)
View(sexvstat)
#fix munip id variable-reassign unique ids
sexvstat <- transform(sexvstat, munip_id = as.numeric(factor(munip)))
print(factor(munip))
print(unique(sexvstat$munip))
View(caseagg)
View(casestat)
#Capitalize munip values to merge with sexual violence data
caseagg$munip <- toupper(caseagg$munip)
# Group by municipality, year, and status and count the number of cases
caseagg <- casestat %>%
group_by(depto, munip, year, status) %>%
count() %>%
ungroup()
# Pivot the data to wide format and rename the columns
caseagg <- caseagg  %>%
pivot_wider(names_from = "status", values_from = "n", values_fn = sum)
caseagg[is.na(caseagg)] <- 0
#Capitalize munip values to merge with sexual violence data
caseagg$munip <- toupper(caseagg$munip)
View(casestat)
print(unique(sexvstat$munip))
munips <- print(unique(sexvstat$munip))
caseagg$munip <- ifelse(caseagg$depto == "Escuintla" & caseagg$munip == "La Democracia",
"La Democracia (escui)", caseagg$munip)
#fix munips with the same names
casestat$munip <- ifelse(casestat$depto == "Escuintla" & casestat$munip == "La Democracia",
"La Democracia (escui)", casestat$munip)
print(munips)
casestat$munip <- ifelse(casestat$depto == "Huehuetenango" & casestat$munip == "La Democracia",
"La Democracia (huehu)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "Huehuetenango" & casestat$munip == "La Libertad",
"La Libertad (huehu)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "peten" & casestat$munip == "La Libertad",
"La Libertad (peten)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "Peten" & casestat$munip == "La Libertad",
"La Libertad (Peten)", casestat$munip)
View(sexvpop)
casestat$munip <- ifelse(casestat$depto == "Escuintla" & casestat$munip == "San Jose",
"San Jose (escui)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "Peten" & casestat$munip == "San Jose",
"San Jose (peten)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "San Marcos" & casestat$munip == "San Lorenzo",
"SAN LORENZO (SNMAR)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "Suchitepequez" & casestat$munip == "San Lorenzo",
"SAN LORENZO (Suchi)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "Guatemala" & casestat$munip == "SAN PEDRO SACATEPEQUEZ", "SAN PEDRO SACATEPEQUEZ (guate)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "Guatemala" & casestat$munip == "San Pedro Sacatepequez", "SAN PEDRO SACATEPEQUEZ (guate)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "San Marcos" & casestat$munip == "San Pedro Sacatepequez", "SAN PEDRO SACATEPEQUEZ (SNMAR)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "Guatemala" & casestat$munip == "San Pedro Sacatepequez", "SAN PEDRO SACATEPEQUEZ (guate)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "Suchitepequez" & casestat$munip == "Santa Barbara", "Santa Barbara (Suchi)", casestat$munip)
casestat$munip <- ifelse(casestat$depto == "Huehuetenango" & casestat$munip == "Santa Barbara", "Santa Barbara (Huehu)", casestat$munip)
caseagg <- casestat %>%
group_by(depto, munip, year, status) %>%
count() %>%
ungroup()
write.csv(sexvstat, "sexvstat.csv", row.names = FALSE)
# Group by municipality, year, and status and count the number of cases
caseagg <- casestat %>%
group_by(depto, munip, year, status) %>%
count() %>%
ungroup()
# Pivot the data to wide format and rename the columns
caseagg <- caseagg  %>%
pivot_wider(names_from = "status", values_from = "n", values_fn = sum)
caseagg[is.na(caseagg)] <- 0
#Capitalize munip values to merge with sexual violence data
caseagg$munip <- toupper(caseagg$munip)
write.csv(caseagg, "caseagg.csv", row.names = FALSE)
# Merge case status data with sexual violence data
sexvstat <- merge(sexvpop, caseagg, by = c("munip", "year"), all = TRUE)
sexvstat[is.na(sexvstat)] <- 0
# Create variable for percentage of sentenced cases
sexvstat$s_rate <- round((sexvstat$Sentenciado / sexvstat$reported), 2)
#drop 2022- incomplete year data
sexvstat <- sexvstat %>%
filter(year != 2022)
#fix munip id variable-reassign unique ids
sexvstat <- transform(sexvstat, munip_id = as.numeric(factor(munip)))
#munips <- print(unique(sexvstat$munip))
write.csv(sexvstat, "sexvstat.csv", row.names = FALSE)
parallel_sent <- ggplot(sexvstat, aes(x=year, y= s_rate, group = treatment, color = treatment))+
stat_summary(fun = "mean", geom = "line", na.rm = TRUE)+
theme_minimal()+
geom_vline(xintercept=2009, color = "#CD9600") +
annotate(geom="text", x=2009.5, y=-1, label="Policy Rollout")+
labs(title= "Average Crime Rate by Treatment Group",
subtitle= "Does the parallel trend assumption hold?",
x = "Year",
y = "Average Crime Rate, rate per 10,000 pop.",
color = "Treatment Group")+
scale_color_manual(values= wes_palette("Darjeeling1", n = 2))+
xlim(2011, 2021) +
ylim(0, 0.25)
parallel_sent
ggsave("parallel_sent.png", width=10)
parallel_sent <- ggplot(sexvstat, aes(x=year, y= s_rate, group = treatment, color = treatment))+
stat_summary(fun = "mean", geom = "line", na.rm = TRUE)+
theme_minimal()+
geom_vline(xintercept=2009, color = "#CD9600") +
annotate(geom="text", x=2009.5, y=-1, label="Policy Rollout")+
labs(title= "Average Crime Rate by Treatment Group",
subtitle= "Does the parallel trend assumption hold?",
x = "Year",
y = "Average Crime Rate, rate per 10,000 pop.",
color = "Treatment Group")+
scale_color_manual(values= wes_palette("Darjeeling1", n = 2))+
xlim(2011, 2021) +
ylim(0, 0.1)
parallel_sent
ggsave("parallel_sent.png", width=10)
parallel_sent <- ggplot(sexvstat, aes(x=year, y= s_rate, group = treatment, color = treatment))+
stat_summary(fun = "mean", geom = "line", na.rm = TRUE)+
theme_minimal()+
geom_vline(xintercept=2009, color = "#CD9600") +
annotate(geom="text", x=2009.5, y=-1, label="Policy Rollout")+
labs(title= "Average Crime Rate by Treatment Group",
subtitle= "Does the parallel trend assumption hold?",
x = "Year",
y = "Average Crime Rate, rate per 10,000 pop.",
color = "Treatment Group")+
scale_color_manual(values= wes_palette("Darjeeling1", n = 2))+
xlim(2011, 2021) +
ylim(0, 0.06)
parallel_sent
ggsave("parallel_sent.png", width=10)
View(sexvstat)
View(sexvpop)
#drop NO REGISTRADO
sexvstat <- sexvstat %>%
filter(munip != "NO REGISTRADO")
View(sexv)
View(pop)
#change rio hondo from sexv data, extra space
sexv$munip <- gsub("RIO  HONDO", "RIO HONDO", sexv$munip)
sexvpop <- merge(sexv, pop, by = c("munip", "year"), all = TRUE)
# Create variable for crime rate per 10,000 people
sexvpop$c_rate <- round((sexvpop$reported / sexvpop$population) * 10000, 2)
#drop 2022- incomplete year data, fix first_treat column and remove NAs from first_treat
sexvpop <- sexvpop %>%
select(-first_treat.y) %>%
rename(first_treat = first_treat.x,
crime_rate = c_rate) %>%
mutate(first_treat = ifelse(is.na(first_treat), 0, first_treat)) %>%
filter(year != 2022)
sexvpop$year <- as.numeric(sexvpop$year)
write.csv(sexvpop, "sexvpop.csv", row.names = FALSE)
View(sexvpop)
# Merge case status data with sexual violence data
sexvstat <- merge(sexvpop, caseagg, by = c("munip", "year"), all = TRUE)
sexvstat[is.na(sexvstat)] <- 0
# Create variable for percentage of sentenced cases
sexvstat$s_rate <- round((sexvstat$Sentenciado / sexvstat$reported), 2)
#drop 2022- incomplete year data
sexvstat <- sexvstat %>%
filter(year != 2022)
#fix munip id variable-reassign unique ids
sexvstat <- transform(sexvstat, munip_id = as.numeric(factor(munip)))
#munips <- print(unique(sexvstat$munip))
#drop NO REGISTRADO
sexvstat <- sexvstat %>%
filter(munip != "NO REGISTRADO")
write.csv(sexvstat, "sexvstat.csv", row.names = FALSE)
View(unique_pop_munip)
View(munip_not_in_sexv)
View(munip_not_in_sexv)
knitr::opts_chunk$set(echo = TRUE)
IRkernel::installspec()
library(IRkernel)
#If working on Rstudio directly from your desktop, make sure to set your working directory
setwd("~Documents/GitHub/PS109S2023")
getwd()
setwd("C:/Users/hanna/Documents/GitHub/PS109S2023")
```
```{r}
anes <- read.csv("anes_latino.csv")
table(anes$dem_hisp)
table(anes$dem_hisptyp_1st)
table(anes$postvote_rvote)
library(dplyr)
install.packages("dplyr")
knitr::opts_chunk$set(echo = TRUE)
IRkernel::installspec()
library(IRkernel)
IRkernel::installspec()
knitr::opts_chunk$set(echo = TRUE)
#setup
library(ggplot2)
library(IRkernel)
library(dplyr)
#install.packages("dplyr")
anes %>% count(anes$dem_hisp)
anes %>% count(anes$dem_hisptyp_1st)
anes %>% sum(count(anes$dem_hisptyp_1st))
sum(!is.na(df$age))
sum(!is.na(anes$postvote_rvote))
IRkernel::installspec()
